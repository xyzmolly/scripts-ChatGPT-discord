# invite_bot.py
import os
import discord
from discord.ext import commands

bot = commands.Bot(command_prefix='!')

@bot.command()
async def geninvite(ctx, max_age: int = 3600, max_uses: int = 1):
    # create invite for the channel where command was used
    try:
        invite = await ctx.channel.create_invite(max_age=max_age, max_uses=max_uses, unique=True, reason=f"Created by {ctx.author}")
        await ctx.send(f"Invite: {invite.url}")
    except discord.Forbidden:
        await ctx.send("I don't have permission to create invites here.")
    except Exception as e:
        await ctx.send("Could not create invite.")
        print(e)

# run with token in DISCORD_TOKEN env var
bot.run(os.environ['DISCORD_TOKEN'])
